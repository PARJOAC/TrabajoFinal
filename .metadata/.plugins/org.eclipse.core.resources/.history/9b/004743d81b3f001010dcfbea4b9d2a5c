import bd.DAOFacturas;
import bd.DAOFacturas.FacturaResumen;
import vista.administrador.VistaAdministrador;

import javax.swing.table.DefaultTableModel;
import java.sql.SQLException;
import java.util.List;

public class ControladorFactura {

    private final VistaAdministrador vista;
    private final DAOFacturas dao;

    public ControladorFactura(VistaAdministrador vista) {
        this.vista = vista;
        this.dao = new DAOFacturas();
        cargarFacturasEnTabla();
    }

    public void cargarFacturasEnTabla() {
        try {
            List<FacturaResumen> facturas = dao.listarFacturas();
            DefaultTableModel modelo = vista.getModeloFacturas();
            modelo.setRowCount(0);

            for (FacturaResumen f : facturas) {
                modelo.addRow(new Object[]{
                        f.id, f.usuario, f.total, f.iva, f.efectivo, f.cambio, f.fecha
                });
            }

        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(vista, "Error al cargar facturas: " + e.getMessage(),
                    "Error", JOptionPane.ERROR_MESSAGE);
        }
    }
}
